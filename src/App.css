:root {
    --app-header-height: 60px;
}

.page {
    padding: 1rem; /* top/bottom 1rem; bottom nav spacing handled by .app-content */
    /* Fill available space so inner scroll areas can work */
    height: 100%;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}
.table-wrap {
    overflow-x: auto;
}

.asset-table {
    width: 100%;
    border-collapse: collapse;
    background: #fff;
}

.asset-table th,
.asset-table td {
    border-bottom: 1px solid #eee;
    padding: 0.65rem 0.75rem;
    text-align: left;
    white-space: nowrap;
}

.asset-table thead th {
    background: #fafafa;
    font-weight: 600;
    vertical-align: middle;
}

/* Sorting controls in table headers */
.asset-table thead th.th-sortable {
    white-space: nowrap;
}
.asset-table thead th .th-label {
    display: inline-flex;
    align-items: center;
}
.asset-table thead th .sort-toggle {
    border: 0;
    background: transparent;
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    margin-left: 4px;
    padding: 0;
    cursor: pointer;
    vertical-align: middle;
}
.asset-table thead th .sort-toggle .tri {
    font-size: 0.6rem;
    line-height: 0.6rem;
    color: #bbb;
}
.asset-table thead th .sort-toggle:hover .tri {
    color: #666;
}
.asset-table thead th .sort-toggle.active.dir-asc .tri.up {
    color: #555;
}
.asset-table thead th .sort-toggle.active.dir-asc .tri.down {
    color: #d0d0d0;
}
.asset-table thead th .sort-toggle.active.dir-desc .tri.down {
    color: #555;
}
.asset-table thead th .sort-toggle.active.dir-desc .tri.up {
    color: #d0d0d0;
}

.table-wrap--sticky {
    position: relative;
    --table-sticky-extra-offset: 0px;
    /* Make the table area its own scroll container so only rows scroll */
    overflow: auto; /* both axes when needed */
    max-height: 100%;
    min-height: 0;
    flex: 1 1 auto;
}

.asset-table--sticky thead th {
    position: sticky;
    top: calc(var(--app-header-height, 0px) + var(--table-sticky-extra-offset, 0px));
    z-index: 5;
    background: #fafafa;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
}
/* When the table sits inside a sticky table container, pin header to the
   container top so the data area scrolls under it (no extra offset). */
.table-wrap--sticky .asset-table--sticky thead th {
    top: 0;
}

/* Asset/toolbars: align controls consistently */
.asset-toolbar {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
}
/* Reorder AssetStatus controls so search/filter sit next to action buttons (to the right) */
.asset-toolbar > :nth-child(1) {
    order: 2;
} /* search */
.asset-toolbar > :nth-child(2) {
    order: 2;
} /* status filter */
.asset-toolbar > :nth-child(3) {
    order: 1;
} /* spacer (flex: 1 inline) */
.asset-toolbar > :nth-child(4) {
    order: 2;
} /* create button */
.asset-toolbar > :nth-child(5) {
    order: 2;
} /* delete button */

/* Grouped actions container (when used) */
.asset-actions {
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

/* Inputs in toolbars match button height and style */
.asset-toolbar .asset-search,
.asset-toolbar .asset-filter {
    padding: 0 0.7rem;
    height: 38px; /* approx .form-button height */
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
    background: #fff;
}
.asset-toolbar .asset-search {
    min-width: 220px;
}

/* Buttons in toolbar: consistent height */
.asset-toolbar .form-button {
    height: 38px;
    display: inline-flex;
    align-items: center;
}

/* Danger button variant */
.form-button--danger {
    background: #c62828;
}
.form-button--danger:hover {
    background: #b71c1c;
}
.form-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

/* Inline status toggle inside asset table */
.status-toggle {
    display: inline-flex;
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    margin-top: 0.35rem;
}
.status-toggle .toggle-btn {
    background: #fff;
    border: 0;
    font-size: 0.78rem;
    padding: 0.3rem 0.55rem;
}
.status-toggle .toggle-btn + .toggle-btn {
    border-left: 1px solid #eee;
}
.status-toggle .toggle-btn:disabled {
    opacity: 0.55;
    cursor: not-allowed;
}

.badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.35rem;
    padding: 0.2rem 0.5rem;
    border-radius: 999px;
    font-size: 0.8rem;
    line-height: 1;
    font-weight: 600;
    text-align: center;
}

.badge-button {
    border: none;
    background: transparent;
    cursor: pointer;
    font: inherit;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0;
}

.badge-button.badge {
    padding: 0.2rem 0.5rem;
}

.badge-button:focus-visible {
    outline: 2px solid #0b57d0;
    outline-offset: 2px;
}


.badge--available {
    background: #e9f8ee;
    color: #177245;
}
.badge--rented {
    background: #e3f2fd;
    color: #0b57d0; /* match marker--rented (blue) */
}
.badge--overdue {
    background: #fff4e5;
    color: #f59e0b; /* match marker--overdue */
}
.badge--suspicious {
    background: #ff1744;
    color: #f1eaea; /* match marker--suspicious */
}
.badge--maintenance {
    background: #fdecef;
    color: #b71c1c;
}

.badge--accident {
    background: #ffe8d9;
    color: #c2410c;
}

.badge--video {
    background: #e0f2fe;
    color: #0b57d0;
}

/* ê´€ë¦¬ë‹¨ê³?ë°°ì? ?¤í???*/
.badge--pending {
    background: #fff4e5;
    color: #f59e0b;
}

.badge--completed {
    background: #e9f8ee;
    color: #177245;
}

.badge--installed {
    background: #e3f2fd;
    color: #0b57d0;
}

.badge--registered {
    background: #f3f4f6;
    color: #374151;
}

.badge--default {
    background: #e5e7eb;
    color: #6b7280;
}

.badge--contract-term {
    background: #e3f2fd;
    color: #0b57d0;
}

.badge--contract-term-short {
    background: #fff7ed;
    color: #b45309;
}

.badge--contract-amount {
    background: #f3f4f6;
    color: #374151;
}

.badge--contract-unpaid {
    background: #ffebee;
    color: #b91c1c;
}

.badge--restart-blocked {
    background: #fee2e2;
    color: #b91c1c;
}

.badge--restart-allowed {
    background: #dcfce7;
    color: #166534;
}

/* rentals-table now renders only required columns; no hidden columns needed */

/* Simple ON/OFF badges for device/engine */
.badge--on {
    background: #e9f8ee;
    color: #177245;
}
.badge--off {
    background: #f3f4f6;
    color: #374151;
}

.badge--diagnostic {
    background: #e3f2fd;
    color: #0b57d0;
    font-weight: 500;
}

.badge--normal {
    background: #e9f8ee;
    color: #177245;
}

.badge--clickable:hover {
    opacity: 0.8;
    transform: translateY(-1px);
    transition: all 0.2s ease;
}

.management-stage-dropdown {
    position: absolute;
    top: calc(100% + 4px);
    right: 0;
    list-style: none;
    margin: 4px 0 0;
    padding: 4px 0;
    min-width: 180px;
    background: #ffffff;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
    z-index: 20;
}

.management-stage-dropdown li {
    list-style: none;
}

.management-stage-dropdown__option {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: transparent;
    padding: 8px 12px;
    font-size: 0.85rem;
    cursor: pointer;
}

.management-stage-dropdown__badge {
    width: 100%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
}

.management-stage-dropdown__option:hover,
.management-stage-dropdown__option:focus-visible {
    background: #f3f4f6;
}

.management-stage-dropdown__option:disabled {
    cursor: not-allowed;
    color: #9ca3af;
}

.management-stage-dropdown__option:disabled .badge {
    opacity: 0.6;
}

.management-stage-dropdown__option:disabled .management-stage-dropdown__badge {
    cursor: not-allowed;
}

/* ì§„ë‹¨ ì½”ë“œ ëª¨ë‹¬ ?¤í???*/
.diagnostic-detail {
    padding: 0;
}

.diagnostic-header {
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #e5e5e5;
}

.diagnostic-info h3 {
    margin: 0 0 0.5rem 0;
    color: #1a73e8;
    font-size: 1.2rem;
}

.diagnostic-info p {
    margin: 0.25rem 0;
    color: #666;
    font-size: 0.9rem;
}

.diagnostic-table {
    display: grid;
    grid-template-columns: 80px 1fr 80px 100px;
    gap: 0;
    border: 1px solid #e5e5e5;
    border-radius: 6px;
    overflow: hidden;
}

.diagnostic-table-header {
    display: contents;
}

.diagnostic-table-header > div {
    background: #f8f9fa;
    padding: 0.75rem 0.5rem;
    font-weight: 600;
    font-size: 0.85rem;
    border-bottom: 1px solid #e5e5e5;
}

.diagnostic-table-row {
    display: contents;
}

.diagnostic-table-row > div {
    padding: 0.75rem 0.5rem;
    border-bottom: 1px solid #f0f0f0;
    font-size: 0.85rem;
    display: flex;
    align-items: center;
}

.diagnostic-table-row:last-child > div {
    border-bottom: none;
}

.diagnostic-code {
    font-family: monospace;
    font-weight: 600;
    color: #1a73e8;
}

.diagnostic-description {
    font-weight: 500;
}

.diagnostic-date {
    color: #666;
    font-size: 0.8rem;
}

.diagnostic-severity {
    font-size: 0.7rem;
    padding: 2px 6px;
}

.diagnostic-severity--high {
    background: #fee2e2;
    color: #991b1b;
}

.diagnostic-severity--medium {
    background: #fef3c7;
    color: #92400e;
}

.diagnostic-severity--low {
    background: #d1fae5;
    color: #065f46;
}

.empty {
    color: #666;
    padding: 1rem 0;
}

/* Rentals: view toggle and map */
.page {
    height: 100%;
    display: flex;
    flex-direction: column;
}
html,
body,
#root {
    height: 100%;
}
html,
body {
    overflow: hidden;
}
.app-layout {
    min-height: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.app-main {
    flex: 1;
    display: flex;
    flex-direction: row;
    min-height: 0;
}

.app-content {
    flex: 1 1 auto;
    min-height: 0;
    min-width: 0; /* prevent flex overflow in row layout */
    overflow: hidden;
}

/* Top Header Bar */
.top-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    height: var(--app-header-height);
    padding: 0 24px;
    background: #fff;
    border-bottom: 1px solid #e5e5e5;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    position: sticky;
    top: 0;
    z-index: 1000;
}

.top-header__left {
    display: flex;
    align-items: center;
    gap: 12px;
}

.top-header__logo {
    width: 32px;
    height: 32px;
    border-radius: 6px;
    object-fit: contain;
    cursor: pointer;
}

.top-header__service-name {
    font-weight: 700;
    font-size: 25px;
    color: #1a73e8;
}

.top-header__right {
    display: flex;
    align-items: center;
    gap: 16px;
}

.top-header__user-id {
    font-size: 14px;
    color: #666;
    font-weight: 500;
}

.top-header__logout-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
    background: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 8px;
    color: #666;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.top-header__logout-btn:hover {
    background: #e8f0fe;
    border-color: #1a73e8;
    color: #1a73e8;
}

.top-header__icon {
    font-size: 16px;
}

.top-header__logo:focus {
    outline: 2px solid #1a73e8;
    outline-offset: 2px;
}

/* Left-side navigation bar */
.navigation-bar {
    /* Fix width without causing flex overflow (padding/border included) */
    box-sizing: border-box;
    width: 80px; /* back to original width */
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    padding: 12px 8px;
    background: #fff;
    border-right: 1px solid #e5e5e5;
    /* Make sidebar handle small landscape heights gracefully */
    max-height: calc(100vh - var(--app-header-height, 0px)); /* subtract header height */
    overflow-y: auto; /* vertical scroll only when needed */
    overflow-x: hidden; /* avoid horizontal scrollbar in sidebar */
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
}

.navigation-bar__info {
    margin-top: auto;
}

.navigation-bar__link {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 10px 8px;
    color: #444;
    text-decoration: none;
    background: transparent;
    border-radius: 10px;
    border: none; /* for button */
    cursor: pointer;
}

.navigation-bar__link:hover {
    background: #f5f5f5;
}

.navigation-bar__link.is-active {
    background: #e8f0fe;
    color: #1a73e8;
}

.navigation-bar__icon {
    font-size: 20px;
}

.navigation-bar__label {
    font-size: 12px;
    text-align: center;
}

/* Asset dialog layout - insurance dialog style */
.asset-dialog {
    padding-bottom: 8px;
}

.asset-dialog__body {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.asset-docs-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

@media (max-width: 768px) {
    .asset-docs-section {
        grid-template-columns: 1fr;
    }
}

.asset-doc {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 10px;
}

.asset-doc__title {
    font-size: 0.95rem;
    font-weight: 600;
    margin-bottom: 8px;
}

.asset-doc__box {
    border: 1px dashed #cfd8dc;
    border-radius: 8px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #fafbfc;
}

.asset-doc__placeholder {
    color: #90a4ae;
    font-size: 0.9rem;
}

.asset-info {
    grid-template-columns: 140px 1fr;
}

.asset-info__label {
    color: #555;
}

.asset-info__value {
    color: #222;
    font-weight: 600;
}

.asset-dates {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.asset-dates__item {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 8px 10px;
}

.asset-dates__label {
    color: #666;
    font-size: 0.85rem;
    margin-bottom: 2px;
}

.asset-dates__value {
    font-weight: 600;
    font-size: 0.9rem;
}

.asset-dialog__footer {
    margin-top: 12px;
    display: flex;
    justify-content: flex-end;
}

.asset-history__item {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 8px 10px;
}

.asset-bottom-row { display: grid; grid-template-columns: 140px 1fr; align-items: center; }

/*
    Responsive behavior for phones (portrait):
    - Move navigation to the bottom as a horizontal bar
    - Give content the full width
*/
@media (orientation: portrait) and (max-width: 768px) {
    :root {
        --app-header-height: 56px;
    }

    .app-main {
        flex-direction: column; /* content above, nav below */
    }

    .navigation-bar {
        order: 2;
        flex: 0 0 auto;
        width: 100%;
        max-height: none;
        flex-direction: row;
        justify-content: space-around;
        align-items: center;
        gap: 4px;
        padding: 6px 8px calc(6px + env(safe-area-inset-bottom, 0px));
        border-right: 0;
        border-top: 1px solid #e5e5e5;
        /* Stick to bottom without covering content (still occupies layout space) */
        position: sticky;
        bottom: 0;
        height: auto;
        overflow: visible;
        backdrop-filter: saturate(140%) blur(2px);
        background: rgba(255, 255, 255, 0.98);
    }

    .navigation-bar__link {
        flex: 1 1 auto;
        padding: 8px 4px;
        min-width: 0; /* allow shrinking evenly */
    }

    .navigation-bar__info {
        margin-top: 0; /* reset vertical auto push in horizontal layout */
    }

    .app-content {
        order: 1;
    }

    /* Top header adjustments for mobile */
    .top-header {
        padding: 0 16px;
        height: var(--app-header-height);
    }

    .top-header__service-name {
        font-size: 16px;
    }

    .top-header__user-id {
        font-size: 13px;
    }

    .top-header__logout-btn {
        padding: 6px 12px;
        font-size: 13px;
    }
}
.view-toggle {
    display: inline-flex;
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 0.75rem;
}
.toggle-btn {
    background: #fff;
    border: none;
    padding: 0.5rem 0.9rem;
    cursor: pointer;
    color: #444;
}
.toggle-btn + .toggle-btn {
    border-left: 1px solid #ddd;
}
.toggle-btn.is-active {
    background: #0057e7;
    color: #fff;
}
/* Light spacing for toolbar when used in sticky header */
.sticky-header .view-toggle {
    margin-bottom: 0;
}

/* Sticky header wrapper for top controls */
.sticky-header {
    position: sticky;
    top: 0;
    z-index: 200;
    background: #fff;
    padding: 0.25rem 0;
}

/* Header row for detail page: align actions left and saved indicator right */
.header-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
}
.saved-indicator {
    margin-right: 8px;
    color: #2e7d32;
    font-weight: 600;
}

.map-view {
    display: flex;
    flex-direction: column;
    flex: 1 1 auto;
    min-height: 0;
}
.map-container {
    width: 100%;
    flex: 1 1 auto;
    height: auto;
    min-height: 200px;
    border: 1px solid #e5e5e5;
    border-radius: 8px;
}
.mini-map {
    height: 340px;
    min-height: 280px;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid #e5e7eb;
}

.legend {
    display: flex;
    gap: 0.75rem;
    align-items: center;
    margin-bottom: 0.5rem;
}
.legend__item {
    color: #444;
    font-size: 0.9rem;
}

/* Utility Classes for Inline Style Replacements */
.link-button {
    background: none;
    border: none;
    color: #2563eb;
    text-decoration: underline;
    cursor: pointer;
    padding: 0;
    font: inherit;
}

.link-button:hover {
    color: #1d4ed8;
}

.file-info {
    font-size: 12px;
    color: #555;
}

.grid-2col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    max-width: 100%;
    overflow: hidden;
}

@media (max-width: 768px) {
    .grid-2col {
        grid-template-columns: 1fr;
        gap: 12px;
    }
}

.grid-info {
    display: grid;
    grid-template-columns: 140px 1fr;
    row-gap: 6px;
    column-gap: 8px;
}

.section-margin-0 {
    margin-top: 0;
}

.card-padding {
    padding: 16px;
}

/* Error Boundary Styles */
.error-boundary {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 400px;
    padding: 2rem;
    background-color: #fef2f2;
    border: 1px solid #fed7d7;
    border-radius: 8px;
    margin: 1rem 0;
}

.error-boundary-content {
    text-align: center;
    max-width: 500px;
}

.error-boundary h2 {
    color: #c53030;
    margin-bottom: 1rem;
}

.error-boundary p {
    color: #4a5568;
    margin-bottom: 1.5rem;
    line-height: 1.5;
}

.error-details {
    text-align: left;
    margin: 1rem 0;
    padding: 1rem;
    background-color: #f7fafc;
    border: 1px solid #e2e8f0;
    border-radius: 4px;
}

.error-details summary {
    cursor: pointer;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.error-stack {
    font-family: "Courier New", monospace;
    font-size: 0.875rem;
    color: #2d3748;
}

.error-stack pre {
    white-space: pre-wrap;
    word-break: break-word;
    margin-top: 0.5rem;
}

.error-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
}

.error-actions .form-button {
    min-width: 120px;
}

/* Leaflet Popup Styling */
.leaflet-popup-content-wrapper {
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    padding: 4px;
}

.leaflet-popup-content {
    margin: 12px 16px;
    line-height: 1.5;
    font-size: 14px;
    min-width: 200px;
}

.leaflet-popup-close-button {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 24px !important;
    height: 24px !important;
    font-size: 18px !important;
    line-height: 22px !important;
    text-align: center !important;
    color: #666 !important;
    text-decoration: none !important;
    font-weight: bold !important;
    background: rgba(255, 255, 255, 0.8) !important;
    border-radius: 50% !important;
    border: 1px solid #ddd !important;
    transition: all 0.2s ease !important;
}

.leaflet-popup-close-button:hover {
    background: #f5f5f5 !important;
    color: #333 !important;
    border-color: #bbb !important;
}

.leaflet-popup-tip-container {
    margin: 0 auto;
}

.leaflet-popup-tip {
    background: white;
    border: 1px solid #ccc;
}

/* Map popup specific content styling */
.popup-content {
    font-family: inherit;
}

.popup-content strong {
    color: #2563eb;
    font-size: 13px;
    display: inline;
    margin: 0;
    border: none;
    padding: 0;
}

.popup-content .status-badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
    margin-top: 4px;
}

/* Simple text-based markers for Leaflet */
/* Leaflet divIcon markers: ensure our CSS wins regardless of load order */
.marker,
.leaflet-marker-icon.marker,
.leaflet-div-icon.marker {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px !important;
    height: 28px !important;
    border-radius: 50%;
    /* font-size no longer needed for svg icons */
    color: #fff;
    line-height: 1;
    border: 2px solid #fff;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
}
.marker--car {
    background: #6b7280;
}
.leaflet-marker-icon.marker.marker--car {
    background: #6b7280;
}
.marker--rental {
    background: #0b57d0;
}
.marker--return {
    background: #c62828;
}
.marker--current {
    background: #1565c0;
}
.marker--rented {
    background: #0b57d0;
}
.marker--overdue {
    background: #f59e0b;
}
.marker--suspicious {
    background: #c62828;
}
.leaflet-marker-icon.marker.marker--current {
    background: #1565c0;
}
.leaflet-marker-icon.marker.marker--rented {
    background: #0b57d0;
}
.leaflet-marker-icon.marker.marker--overdue {
    background: #f59e0b;
}
.leaflet-marker-icon.marker.marker--suspicious {
    background: #c62828;
}

/* Geofence marker: hatch pattern inside circle (gray, 45deg) */
.marker--geo,
.leaflet-marker-icon.marker.marker--geo {
    background-color: #f3f4f6; /* light gray base */
    background-image: repeating-linear-gradient(
        45deg,
        rgba(107, 114, 128, 0.32) 0px,
        /* gray line */ rgba(107, 114, 128, 0.32) 2px,
        transparent 2px,
        transparent 8px /* 2px line + 6px gap => 8px period */
    );
    border-color: #6b7280; /* gray border */
}

/* Small SVG icons inside markers and legend items */
.map-icon-svg {
    width: 16px;
    height: 16px;
    display: inline-block;
    vertical-align: middle;
    color: inherit; /* inherit marker background color for fill via currentColor */
}

/* Ensure svg paths use currentColor when bundled - some icon svgs already support this */
.map-icon-svg svg {
    width: 16px;
    height: 16px;
}

/* MarkerCluster custom cluster icons */
.cluster,
.leaflet-marker-icon.cluster {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px !important;
    height: 40px !important;
    border-radius: 50%;
    color: #fff;
    font-weight: 700;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    border: 2px solid #fff;
    will-change: transform;
}
.cluster__inner {
    line-height: 1;
    font-size: 14px;
}
.cluster--active {
    background: #0b57d0;
}
.cluster--mixed {
    background: linear-gradient(180deg, #0b57d0, #0b57d0);
    color: #fff;
    position: relative;
}
.cluster__count {
    font-size: 13px;
    font-weight: 700;
    line-height: 1;
}
.cluster__parts {
    display: flex;
    gap: 4px;
    position: absolute;
    bottom: -6px;
    left: 50%;
    transform: translateX(-50%);
}
.cluster-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 18px;
    height: 18px;
    padding: 0 6px;
    border-radius: 99px;
    font-size: 11px;
    color: #fff;
    font-weight: 700;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}
.cluster-badge--rented {
    background: #0b57d0;
}
.cluster-badge--overdue {
    background: #f59e0b;
}
.cluster-badge--suspicious {
    background: #c62828;
}
.cluster--overdue {
    background: #f59e0b;
}
.cluster--stolen {
    background: #c62828;
}

/* Offset clusters so different status groups at same position don't overlap
   Note: Leaflet positions markers using inline transform; use margins here so offsets apply additively. */
.leaflet-marker-icon.cluster.cluster--active {
    margin-left: -50px;
    margin-top: -50px;
    z-index: 402 !important;
}
.leaflet-marker-icon.cluster.cluster--overdue {
    margin-left: 50px;
    margin-top: -50px;
    z-index: 403 !important;
}
.leaflet-marker-icon.cluster.cluster--stolen {
    margin-left: 50px;
    margin-top: 50px;
    z-index: 404 !important;
}

/* Left navigation (converted from bottom nav) */
.bottom-nav {
    position: relative;
    width: 72px;
    min-width: 72px;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    border-right: 1px solid #e5e5e5;
    background: #ffffff;
    padding: 8px 4px;
    z-index: 1000;
}

/* Map legend (filter toggles) */
.map-view {
    position: relative;
}
.legend {
    position: absolute;
    top: 10px;
    right: 10px; /* avoid overlapping Leaflet zoom (top-left) */
    left: auto;
    display: flex;
    flex-direction: column; /* vertical legend */
    align-items: flex-start; /* left-align items */
    gap: 8px;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 6px;
    z-index: 500;
    backdrop-filter: saturate(140%) blur(2px);
}
.legend__item {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 6px;
    border-radius: 6px;
    cursor: pointer;
    border: none;
    background: transparent;
    color: inherit;
    font: inherit;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
}
.legend__item:hover {
    background: #f3f4f6;
}
.legend__item.is-off {
    opacity: 0.45;
    text-decoration: line-through;
}
.legend__label {
    font-size: 12px;
}

/* Removed old geofence legend box styles (now using circular marker) */

.bottom-nav__link {
    flex: 0 0 auto;
    width: 100%;
    text-align: center;
    color: #444;
    text-decoration: none;
    font-size: 0.9rem;
    padding: 10px 4px;
    /* Make it work for both <a> and <button> */
    appearance: none;
    -webkit-appearance: none;
    background: transparent;
    border: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
    position: relative; /* for tooltip positioning */
    border-radius: 10px;
}

.bottom-nav__link.is-active {
    color: #0057e7;
    font-weight: 600;
}

/* Tooltip label: hidden by default, shows on hover/focus */
.bottom-nav__label {
    position: absolute;
    top: 50%;
    left: calc(100% + 8px);
    transform: translate(0, -50%);
    opacity: 0;
    pointer-events: none;
    background: #111;
    color: #fff;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 12px;
    line-height: 1.2;
    white-space: nowrap;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    transition: opacity 120ms ease, transform 120ms ease;
    z-index: 1001;
}
.bottom-nav__label::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 0;
    transform: translate(-100%, -50%);
    width: 0;
    height: 0;
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-right: 6px solid #111;
}
.bottom-nav__link:hover .bottom-nav__label,
.bottom-nav__link:focus .bottom-nav__label,
.bottom-nav__link:focus-visible .bottom-nav__label,
.bottom-nav__link:active .bottom-nav__label {
    opacity: 1;
    transform: translate(0, -50%);
}

/* Icon for bottom nav items that use emojis or inline SVG */
.bottom-nav__icon {
    font-size: 22px;
    line-height: 1;
}

/* Visible focus style for accessibility */
.bottom-nav__link:focus-visible {
    outline: 2px solid #0b57d0;
    outline-offset: 2px;
    border-radius: 10px;
}

/* Top-right global controls */
.top-controls {
    position: fixed;
    top: calc(8px + env(safe-area-inset-top, 0px));
    right: 8px;
    display: inline-flex;
    gap: 8px;
    align-items: center;
    background: rgba(255, 255, 255, 0.92);
    border: 1px solid #e5e5e5;
    border-radius: 999px;
    padding: 6px 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
    z-index: 1100; /* Above bottom nav (1000) and sticky headers */
}
.top-controls__link,
.top-controls__button {
    appearance: none;
    -webkit-appearance: none;
    background: transparent;
    border: none;
    color: #333;
    text-decoration: none;
    font-size: 0.95rem;
    padding: 4px 8px;
    border-radius: 6px;
    cursor: pointer;
}
.top-controls__button:hover,
.top-controls__link:hover {
    background: #f2f6ff;
    color: #0b57d0;
}

/* Login */
.login-container {
    min-height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem 1rem;
    background: linear-gradient(180deg, #f7f9fc 0%, #ffffff 100%);
}
.login-card {
    width: 100%;
    max-width: 420px;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
    padding: 1.25rem;
}
.login-title {
    margin: 0 0 1rem;
    font-size: 1.5rem;
}
.login-form {
    display: grid;
    gap: 0.75rem;
}
.login-label {
    font-size: 0.9rem;
    color: #333;
}
.login-input {
    padding: 0.6rem 0.7rem;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
}
.login-button {
    margin-top: 0.25rem;
    background: #0057e7;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 0.7rem 1rem;
    font-size: 1rem;
    cursor: pointer;
}
.login-button:hover {
    background: #064dc9;
}
.login-help {
    margin-top: 0.75rem;
    color: #666;
    font-size: 0.9rem;
}

/* Generic form styles */
.form-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.6rem;
    max-width: 640px;
}
.form-label {
    font-size: 0.9rem;
    color: #333;
}
.form-input {
    padding: 0.55rem 0.7rem;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
}
.form-actions {
    margin-top: 0.5rem;
}
.form-button {
    background: #0057e7;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 0.7rem 1rem;
    font-size: 1rem;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.45rem;
    line-height: 1.2;
    font-weight: 600;
    transition: background-color 0.2s ease, opacity 0.2s ease;
}
.form-button:hover {
    background: #064dc9;
}

.form-button--accent {
    background: #2196f3;
}
.form-button--accent:hover {
    background: #1976d2;
}

.form-button--neutral {
    background: #607d8b;
}
.form-button--neutral:hover {
    background: #546a7a;
}

.form-button--muted {
    background: #6c757d;
}
.form-button--muted:hover {
    background: #5a6268;
}

.form-button--warning {
    background: #ff5722;
}
.form-button--warning:hover {
    background: #e64a19;
}

/* Small inline button for table actions */
.mini-button {
    background: #f3f4f6;
    color: #111827;
    border: 1px solid #e5e7eb;
    border-radius: 999px;
    padding: 4px 10px;
    font-size: 12px;
    cursor: pointer;
}
.mini-button.is-on {
    background: #0b57d0;
    color: #fff;
    border-color: #0b57d0;
}

/* Scroll containers between sticky header and bottom nav */
.page-scroll {
    flex: 1 1 auto;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: auto;
    padding-bottom: 0;
}

/* Normalize headings to avoid extra top margins pushing layout */
.page > h1 {
    margin: 0 0 0.75rem;
}
/* Global sizing reset to avoid off-by-one overflows */
html {
    box-sizing: border-box;
}
*,
*::before,
*::after {
    box-sizing: inherit;
}

/* Dashboard */
.dashboard-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
}
@media (min-width: 920px) {
    .dashboard-grid {
        grid-template-columns: 1fr 1fr;
    }
    .dashboard-grid--gauges {
        grid-template-columns: repeat(3, 1fr);
    }
}
.card {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 12px;
    padding: 1rem;
}

.card--active {
    border-color: #1a73e8;
    box-shadow: 0 2px 8px rgba(26, 115, 232, 0.15);
}
.section-title {
    margin: 0 0 0.5rem;
    font-size: 1.1rem;
}
.chart-card .chart-wrap {
    /* Responsive to both width and height; never exceed a fraction of viewport */
    height: min(clamp(160px, 34vw, 260px), 38vh);
}
.gauge-card {
    text-align: center;
}
.gauge {
    width: 100%;
    max-width: 280px;
    margin: 0 auto;
}
.gauge {
    /* Ensure the container keeps space for the semicircle so parent flex layouts don't squash it */
    min-height: 140px; /* reasonable default for size ~280 */
}
.gauge svg {
    width: 100%;
    height: 90%;
    display: block;
}
.gauge-title {
    font-weight: 600;
    margin-bottom: 0.25rem;
}
.gauge-sub {
    display: block;
    font-weight: 400;
    font-size: 0.85rem;
    color: #6b7280;
}
.gauge-footer {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.6rem;
    margin-top: -6px;
}
.gauge-value {
    font-size: 1.6rem;
    font-weight: 700;
}
.gauge-delta {
    font-size: 0.95rem;
    color: #374151;
}
.gauge-delta.up {
    color: #065f46;
}
.gauge-delta.down {
    color: #991b1b;
}

/* Simple modal styles */
.modal-backdrop {
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding: 40px 16px;
    z-index: 1200;
}
.modal {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 12px;
    width: 100%;
    max-width: 720px;
    padding: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    max-height: calc(100vh - 80px);
    overflow: auto;
}

.modal-large {
    max-width: 1200px;
}

.modal-small {
    max-width: 480px;
}

/* Management Stage Dropdown Styles */
.management-stage-dropdown {
    position: absolute;
    top: calc(100% + 4px);
    left: 0;
    background: white;
    border: 1px solid #ddd;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    min-width: 140px;
    padding: 4px 0;
    margin: 0;
    list-style: none;
}

.management-stage-dropdown__option {
    display: block;
    width: 100%;
    padding: 8px 12px;
    border: none;
    background: none;
    text-align: left;
    cursor: pointer;
    font-size: 0.85rem;
    transition: background-color 0.2s ease;
}

.management-stage-dropdown__option:hover {
    background-color: #f8f9fa;
}

.management-stage-dropdown__option:disabled {
    cursor: not-allowed;
    opacity: 0.6;
}

.management-stage-dropdown__badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
}

/* ProblemVehicles current-location modal styling */
.header-row.has-overlay {
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    padding: 16px 20px;
    background: #f9fafb;
    border-bottom: 1px solid #e5e7eb;
    border-radius: 8px 8px 0 0;
    margin: -20px -20px 20px -20px;
}

.header-row.has-overlay strong {
    font-size: 18px;
    font-weight: 600;
    color: #1f2937;
}

.header-row.has-overlay .modal-title-overlay {
    position: absolute;
    left: 20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 14px;
    color: #6b7280;
    font-weight: normal;
    pointer-events: none;
}

.header-row.has-overlay .form-button {
    padding: 8px 16px;
    font-size: 14px;
    border-radius: 6px;
    background: #6b7280 !important;
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.header-row.has-overlay .form-button:hover {
    background: #4b5563 !important;
}

/* Modal content area improvements for location modal */
.modal.has-overlay .modal-content {
    padding: 0;
}

.modal.has-overlay .modal-body {
    padding: 0;
}

.modal.has-overlay .mini-map {
    margin: 0;
    border-radius: 0 0 8px 8px;
    border: none;
    border-top: 1px solid #e5e7eb;
}
